unit UDMImpr;

interface

uses
  SysUtils, Classes, DB, DBClient, MConnect, SConnect;

type
  TDMImpr = class(TDataModule)
    cdsImprPed: TClientDataSet;
    cdsImprClientesUF: TClientDataSet;
    cdsImprHistClientes3: TClientDataSet;
    cdsImprHistClientes2: TClientDataSet;
    cdsImprHistClientes1: TClientDataSet;
    cdsImprEst: TClientDataSet;
    cdsImprNfDups: TClientDataSet;
    cdsImprNfItem: TClientDataSet;
    cdsImprNf: TClientDataSet;
    cdsImprPedItem: TClientDataSet;
    SCServerImpr: TSocketConnection;
    cdsImprDemPrev: TClientDataSet;
    cdsImprNfVend: TClientDataSet;
    cdsImprNfSerie: TClientDataSet;
    cdsImprNfDupsDUPLICATA_SQ: TIntegerField;
    cdsImprNfDupsNUMERO_DUPLICATA: TIntegerField;
    cdsImprNfDupsITEM_DUPLICATA: TIntegerField;
    cdsImprNfDupsSEQ_DUPLICATA: TIntegerField;
    cdsImprNfDupsNFISCAL_SQ: TIntegerField;
    cdsImprNfDupsVALOR_DUPLICATA: TBCDField;
    cdsImprNfDupsDTEMISSAO_DUPLICATA: TDateTimeField;
    cdsImprNfDupsDTVENCTO_DUPLICATA: TDateTimeField;
    cdsImprNfDupsDTPGTO_DUPLICATA: TDateTimeField;
    cdsImprNfDupsVALORPG_DUPLICATA: TBCDField;
    cdsImprNfVendNFISCAL_SQ: TIntegerField;
    cdsImprNfVendNUMERO_NFISCAL: TIntegerField;
    cdsImprNfVendDTEMISSAO_NFISCAL: TDateTimeField;
    cdsImprNfVendVLR_TOTAL: TBCDField;
    cdsImprNfVendDUP1: TIntegerField;
    cdsImprNfVendIT1: TIntegerField;
    cdsImprNfVendVLR1: TBCDField;
    cdsImprNfVendVCT1: TDateTimeField;
    cdsImprNfVendDUP2: TIntegerField;
    cdsImprNfVendIT2: TIntegerField;
    cdsImprNfVendVLR2: TBCDField;
    cdsImprNfVendVCT2: TDateTimeField;
    cdsImprNfVendDUP3: TIntegerField;
    cdsImprNfVendIT3: TIntegerField;
    cdsImprNfVendVLR3: TBCDField;
    cdsImprNfVendVCT3: TDateTimeField;
    cdsImprNfVendDUP4: TIntegerField;
    cdsImprNfVendIT4: TIntegerField;
    cdsImprNfVendVLR4: TBCDField;
    cdsImprNfVendVCT4: TDateTimeField;
    cdsImprNfVendDUP5: TIntegerField;
    cdsImprNfVendIT5: TIntegerField;
    cdsImprNfVendVLR5: TBCDField;
    cdsImprNfVendVCT5: TDateTimeField;
    cdsImprNfVendVENDEDOR_SQ: TIntegerField;
    cdsImprNfVendNOME_VENDEDOR: TStringField;
    cdsImprNfVendCODIGO_CLIENTE: TStringField;
    cdsImprNfVendNOME_CLIENTE: TStringField;
    cdsImprHistClientes1CLIENTE_SQ: TIntegerField;
    cdsImprHistClientes1CODIGO_CLIENTE: TStringField;
    cdsImprHistClientes1NOME_CLIENTE: TStringField;
    cdsImprHistClientes1INSCR_ESTADUAL: TStringField;
    cdsImprHistClientes1ENDERECO: TStringField;
    cdsImprHistClientes1NUMERO: TStringField;
    cdsImprHistClientes1BAIRRO: TStringField;
    cdsImprHistClientes1COMPL_ENDERECO: TStringField;
    cdsImprHistClientes1CIDADE: TStringField;
    cdsImprHistClientes1ESTADO: TStringField;
    cdsImprHistClientes1CEP: TStringField;
    cdsImprHistClientes1DDD_FONE1: TStringField;
    cdsImprHistClientes1NUMERO_FONE1: TStringField;
    cdsImprHistClientes1COMPL_FONE1: TStringField;
    cdsImprHistClientes1DDD_FONE2: TStringField;
    cdsImprHistClientes1NUMERO_FONE2: TStringField;
    cdsImprHistClientes1COMPL_FONE2: TStringField;
    cdsImprHistClientes1DDD_FONE3: TStringField;
    cdsImprHistClientes1NUMERO_FONE3: TStringField;
    cdsImprHistClientes1COMPL_FONE3: TStringField;
    cdsImprHistClientes1DDD_CELULAR: TStringField;
    cdsImprHistClientes1NUMERO_CELULAR: TStringField;
    cdsImprHistClientes1COMPL_CELULAR: TStringField;
    cdsImprHistClientes1DDD_FAX: TStringField;
    cdsImprHistClientes1NUMERO_FAX: TStringField;
    cdsImprHistClientes1COMPL_FAX: TStringField;
    cdsImprHistClientes1E_MAIL: TStringField;
    cdsImprHistClientes1WEB_SITE: TStringField;
    cdsImprHistClientes1CONTATO: TStringField;
    cdsImprHistClientes1PAIS: TStringField;
    cdsImprHistClientes1REVENDA: TStringField;
    cdsImprHistClientes1BIRO: TStringField;
    cdsImprPedPEDIDO_SQ: TIntegerField;
    cdsImprPedDDD_FONE1: TStringField;
    cdsImprPedNUMERO_FONE1: TStringField;
    cdsImprPedCOMPL_FONE1: TStringField;
    cdsImprPedDDD_CELULAR: TStringField;
    cdsImprPedNUMERO_CELULAR: TStringField;
    cdsImprPedCOMPL_CELULAR: TStringField;
    cdsImprPedENDERECO: TStringField;
    cdsImprPedNUMERO: TStringField;
    cdsImprPedCOMPL_ENDERECO: TStringField;
    cdsImprPedDDD_FONE2: TStringField;
    cdsImprPedNUMERO_FONE2: TStringField;
    cdsImprPedCOMPL_FONE2: TStringField;
    cdsImprPedDDD_FONE3: TStringField;
    cdsImprPedNUMERO_FONE3: TStringField;
    cdsImprPedCOMPL_FONE3: TStringField;
    cdsImprPedDDD_FAX: TStringField;
    cdsImprPedNUMERO_FAX: TStringField;
    cdsImprNfSerieNFISCAL_SQ: TIntegerField;
    cdsImprNfSerieNUMERO_NFISCAL: TIntegerField;
    cdsImprNfSerieDTEMISSAO_NFISCAL: TDateTimeField;
    cdsImprNfSerieDTSAIDA_NFISCAL: TDateTimeField;
    cdsImprNfSeriePEDIDO_SQ: TIntegerField;
    cdsImprNfSerieCLIENTE_SQ: TIntegerField;
    cdsImprNfSerieCOND_PAGTO_SQ: TIntegerField;
    cdsImprNfSerieNATUREZA_SQ: TIntegerField;
    cdsImprNfSerieTRANSPORTADORA_SQ: TIntegerField;
    cdsImprNfSerieBASE_ICMS: TBCDField;
    cdsImprNfSerieVLR_ICMS: TBCDField;
    cdsImprNfSerieBASE_ICMS_SUBST: TBCDField;
    cdsImprNfSerieVLR_ICMS_SUBST: TBCDField;
    cdsImprNfSerieVLR_PRODUTOS: TBCDField;
    cdsImprNfSerieVLR_FRETE: TBCDField;
    cdsImprNfSerieVLR_SEGURO: TBCDField;
    cdsImprNfSerieVLR_DESP_ACESS: TBCDField;
    cdsImprNfSerieVLR_IPI: TBCDField;
    cdsImprNfSerieVLR_TOTAL: TBCDField;
    cdsImprNfSerieFRETE_TRANSP: TStringField;
    cdsImprNfSeriePLACA_TRANSP: TStringField;
    cdsImprNfSerieUF_PLACA_TRANSP: TStringField;
    cdsImprNfSerieQTDE_TRANSP: TIntegerField;
    cdsImprNfSerieESPECIE_TRANSP: TStringField;
    cdsImprNfSerieMARCA_TRANSP: TStringField;
    cdsImprNfSerieNUMERO_TRANSP: TStringField;
    cdsImprNfSeriePBRUTO_TRANSP: TStringField;
    cdsImprNfSeriePLIQUIDO_TRANSP: TStringField;
    cdsImprNfSerieCLASS_FISCAL1: TIntegerField;
    cdsImprNfSerieCLASS_FISCAL2: TIntegerField;
    cdsImprNfSerieCLASS_FISCAL3: TIntegerField;
    cdsImprNfSerieCLASS_FISCAL4: TIntegerField;
    cdsImprNfSerieCLASS_FISCAL5: TIntegerField;
    cdsImprNfSerieCLASS_FISCAL6: TIntegerField;
    cdsImprNfSerieCLASS_FISCAL7: TIntegerField;
    cdsImprNfSerieCANCELADA: TStringField;
    cdsImprNfSerieDIAS_DEMONSTRACAO: TIntegerField;
    cdsImprNfSerieCOTACAO_DOLAR: TBCDField;
    cdsImprNfSerieNR_NFISCAL_RETORNO: TIntegerField;
    cdsImprNfSerieDT_NFISCAL_RETORNO: TDateTimeField;
    cdsImprNfSerieCONCLUIDA: TStringField;
    cdsImprNfSerieVENDEDOR_SQ: TIntegerField;
    cdsImprNfSerieNF_MANUAL: TStringField;
    cdsImprNfSerieNOME_CLIENTE: TStringField;
    cdsImprNfSerieDESCRICAO_COND_PAGTO: TStringField;
    cdsImprNfSerieDESCRICAO_NATUREZA: TStringField;
    cdsImprNfSerieNOME_VENDEDOR: TStringField;
    cdsImprNfNFISCAL_SQ: TIntegerField;
    cdsImprNfNOME_CLIENTE: TStringField;
    cdsImprNfCODIGO_CLIENTE: TStringField;
    cdsImprNfINSCR_ESTADUAL: TStringField;
    cdsImprNfENDERECO: TStringField;
    cdsImprNfCOMPL_ENDERECO: TStringField;
    cdsImprNfNUMERO: TStringField;
    cdsImprNfENT_SAI: TStringField;
    cdsImprNfBAIRRO: TStringField;
    cdsImprNfCIDADE: TStringField;
    cdsImprNfESTADO: TStringField;
    cdsImprNfCEP: TStringField;
    cdsImprNfDTEMISSAO_NFISCAL: TDateTimeField;
    cdsImprNfDTSAIDA_NFISCAL: TDateTimeField;
    cdsImprNfDESCRICAO_NATUREZA_NFISCAL: TStringField;
    cdsImprNfCFO: TStringField;
    cdsImprNfBASE_ICMS: TBCDField;
    cdsImprNfVLR_FRETE: TBCDField;
    cdsImprNfVLR_ICMS: TBCDField;
    cdsImprNfBASE_ICMS_SUBST: TBCDField;
    cdsImprNfVLR_SEGURO: TBCDField;
    cdsImprNfVLR_DESP_ACESS: TBCDField;
    cdsImprNfVLR_ICMS_SUBST: TBCDField;
    cdsImprNfVLR_TOTAL: TBCDField;
    cdsImprNfVLR_PRODUTOS: TBCDField;
    cdsImprNfVLR_IPI: TBCDField;
    cdsImprNfNOME_TRANSPORTADORA: TStringField;
    cdsImprNfENDERECO_TRANSPORTADORA: TStringField;
    cdsImprNfINSCR_ESTADUAL_TRANSP: TStringField;
    cdsImprNfQTDE_TRANSP: TIntegerField;
    cdsImprNfESTADO_TRANSPORTADORA: TStringField;
    cdsImprNfMUNICIPIO_TRANSPORTADORA: TStringField;
    cdsImprNfPLIQUIDO_TRANSP: TStringField;
    cdsImprNfPBRUTO_TRANSP: TStringField;
    cdsImprNfNUMERO_TRANSP: TStringField;
    cdsImprNfMARCA_TRANSP: TStringField;
    cdsImprNfESPECIE_TRANSP: TStringField;
    cdsImprNfCODIGO_TRANSPORTADORA: TStringField;
    cdsImprNfUF_PLACA_TRANSP: TStringField;
    cdsImprNfPLACA_TRANSP: TStringField;
    cdsImprNfFRETE_TRANSP: TStringField;
    cdsImprNfCLASS_FISCAL1: TIntegerField;
    cdsImprNfCLASS_FISCAL2: TIntegerField;
    cdsImprNfCLASS_FISCAL3: TIntegerField;
    cdsImprNfCLASS_FISCAL4: TIntegerField;
    cdsImprNfCLASS_FISCAL5: TIntegerField;
    cdsImprNfCLASS_FISCAL6: TIntegerField;
    cdsImprNfCLASS_FISCAL7: TIntegerField;
    cdsImprNfDDD_FONE1: TStringField;
    cdsImprNfNUMERO_FONE1: TStringField;
    cdsImprNfCOMPL_FONE1: TStringField;
    cdsImprNfNUMERO_NFISCAL: TIntegerField;
    cdsImprNfPARCELAS: TIntegerField;
    cdsImprNfCOND_PAGTO_SQ: TIntegerField;
    cdsImprNfNATUREZA_SQ: TIntegerField;
    cdsImprNfDIAS_DEMONSTRACAO: TIntegerField;
    cdsImprDemPrevNUMERO_NFISCAL: TIntegerField;
    cdsImprDemPrevNOME_CLIENTE: TStringField;
    cdsImprDemPrevDTEMISSAO_NFISCAL: TDateTimeField;
    cdsImprDemPrevDIAS_DEMONSTRACAO: TIntegerField;
    cdsImprDemPrevDT_NFISCAL_RETORNO: TDateTimeField;
    cdsImprNfFech: TClientDataSet;
    cdsImprNfFechNUMERO_NFISCAL: TIntegerField;
    cdsImprNfFechCFO: TStringField;
    cdsImprNfFechDESCRICAO_NATUREZA_NFISCAL: TStringField;
    cdsImprNfFechVLR_PRODUTOS: TBCDField;
    cdsImprNfFechVLR_TOTAL: TBCDField;
    cdsImprNfFechVLR_ICMS: TBCDField;
    cdsImprNfFechVLR_IPI: TBCDField;
    cdsImprNfFechNOME_CLIENTE: TStringField;
    cdsImprNfFechENT_SAI: TStringField;
    cdsImprNfFechTIPO_NFISCAL: TIntegerField;
    cdsImprNfFechCANCELADA: TStringField;
    cdsImprPedCOMPL_FAX: TStringField;
    cdsImprPedCODIGO_CLIENTE: TStringField;
    cdsImprPedNOME_CLIENTE: TStringField;
    cdsImprPedCONTATO: TStringField;
    cdsImprPedINSCR_ESTADUAL: TStringField;
    cdsImprPedBAIRRO: TStringField;
    cdsImprPedCIDADE: TStringField;
    cdsImprPedESTADO: TStringField;
    cdsImprPedPAIS: TStringField;
    cdsImprPedCEP: TStringField;
    cdsImprPedNOME_VENDEDOR: TStringField;
    cdsImprPedCODIGO_VENDEDOR: TIntegerField;
    cdsImprPedTIPO_NFISCAL: TIntegerField;
    cdsImprPedDESCRICAO_NATUREZA: TStringField;
    cdsImprPedCFO: TStringField;
    cdsImprPedCODIGO_TRANSPORTADORA: TStringField;
    cdsImprPedNOME_TRANSPORTADORA: TStringField;
    cdsImprPedVLR_FRETE: TBCDField;
    cdsImprPedFRETE_TRANSP: TStringField;
    cdsImprPedDIAS_DEMONSTRACAO: TIntegerField;
    cdsImprPedDATA_PEDIDO: TDateTimeField;
    cdsImprPedNUMERO_PEDIDO: TIntegerField;
    cdsImprPedCOTACAO_DOLAR: TBCDField;
    cdsImprPedVLR_PRODUTOS: TBCDField;
    cdsImprPedVLR_IPI: TBCDField;
    cdsImprPedVLR_ICMS: TBCDField;
    cdsImprPedD00: TIntegerField;
    cdsImprPedD01: TIntegerField;
    cdsImprPedD02: TIntegerField;
    cdsImprPedD03: TIntegerField;
    cdsImprPedD04: TIntegerField;
    cdsImprPedD05: TIntegerField;
    cdsImprPedD06: TIntegerField;
    cdsImprPedD07: TIntegerField;
    cdsImprPedD08: TIntegerField;
    cdsImprPedD09: TIntegerField;
    cdsImprPedPARCELAS: TIntegerField;
    cdsImprPedDESCRICAO_COND_PAGTO: TStringField;
    cdsImprPedOBSERVACAO_NAT: TMemoField;
    cdsImprPedOBSERVACAO_PED: TMemoField;
    cdsImprPedOBSERVACAO_NF: TMemoField;
    cdsImprNfSerieNR_SERIE_ITEM: TMemoField;
    cdsImprNfSerieMENSAGEM: TMemoField;
    cdsImprNfMENSAGEM: TMemoField;
    cdsImprNfSerieRETORNO_PRODUTO: TStringField;
    cdsImprNfSerieRETORNO_OBSERVACAO: TMemoField;
    cdsImprAssist: TClientDataSet;
    cdsImprAssistItem: TClientDataSet;
    cdsImprAssistEquip: TClientDataSet;
    cdsImprAssistASSISTENCIA_SQ: TIntegerField;
    cdsImprAssistNUMERO_ASSISTENCIA: TIntegerField;
    cdsImprAssistDATA_CHAMADO: TDateTimeField;
    cdsImprAssistDATA_ASSISTENCIA: TDateTimeField;
    cdsImprAssistCOTACAO_DOLAR: TBCDField;
    cdsImprAssistCLIENTE_SQ: TIntegerField;
    cdsImprAssistCOND_PAGTO_SQ: TIntegerField;
    cdsImprAssistDESP_CHAMADO: TBCDField;
    cdsImprAssistDESP_HTEC_AD: TBCDField;
    cdsImprAssistDESP_DESLOC: TBCDField;
    cdsImprAssistVLR_PECAS: TBCDField;
    cdsImprAssistVLR_TOTAL: TBCDField;
    cdsImprAssistHORA_INICIO: TTimeField;
    cdsImprAssistHORA_FIM: TTimeField;
    cdsImprAssistGARANTIA: TStringField;
    cdsImprAssistCONTRATO: TStringField;
    cdsImprAssistSERVICOS: TMemoField;
    cdsImprAssistDDD_FONE1: TStringField;
    cdsImprAssistNUMERO_FONE1: TStringField;
    cdsImprAssistCOMPL_FONE1: TStringField;
    cdsImprAssistDDD_CELULAR: TStringField;
    cdsImprAssistNUMERO_CELULAR: TStringField;
    cdsImprAssistCOMPL_CELULAR: TStringField;
    cdsImprAssistENDERECO: TStringField;
    cdsImprAssistNUMERO: TStringField;
    cdsImprAssistCOMPL_ENDERECO: TStringField;
    cdsImprAssistDDD_FONE2: TStringField;
    cdsImprAssistNUMERO_FONE2: TStringField;
    cdsImprAssistCOMPL_FONE2: TStringField;
    cdsImprAssistDDD_FONE3: TStringField;
    cdsImprAssistNUMERO_FONE3: TStringField;
    cdsImprAssistCOMPL_FONE3: TStringField;
    cdsImprAssistDDD_FAX: TStringField;
    cdsImprAssistNUMERO_FAX: TStringField;
    cdsImprAssistCOMPL_FAX: TStringField;
    cdsImprAssistCODIGO_CLIENTE: TStringField;
    cdsImprAssistNOME_CLIENTE: TStringField;
    cdsImprAssistCONTATO: TStringField;
    cdsImprAssistINSCR_ESTADUAL: TStringField;
    cdsImprAssistBAIRRO: TStringField;
    cdsImprAssistCIDADE: TStringField;
    cdsImprAssistESTADO: TStringField;
    cdsImprAssistPAIS: TStringField;
    cdsImprAssistCEP: TStringField;
    cdsImprAssistD00: TIntegerField;
    cdsImprAssistD01: TIntegerField;
    cdsImprAssistD02: TIntegerField;
    cdsImprAssistD03: TIntegerField;
    cdsImprAssistD04: TIntegerField;
    cdsImprAssistD05: TIntegerField;
    cdsImprAssistD06: TIntegerField;
    cdsImprAssistD07: TIntegerField;
    cdsImprAssistD08: TIntegerField;
    cdsImprAssistD09: TIntegerField;
    cdsImprAssistPARCELAS: TIntegerField;
    cdsImprAssistDESCRICAO_COND_PAGTO: TStringField;
    cdsImprNFServicos: TClientDataSet;
    cdsImprNFServicosNF_SERVICO_SQ: TIntegerField;
    cdsImprNFServicosNUMERO_NF_SERVICO: TIntegerField;
    cdsImprNFServicosDATA_NF_SERVICO: TDateTimeField;
    cdsImprNFServicosCLIENTE_SQ: TIntegerField;
    cdsImprNFServicosTTL_NF_SERVICO: TBCDField;
    cdsImprNFServicosALIQ_ISS_NF_SERVICO: TBCDField;
    cdsImprNFServicosVLR_ISS_NF_SERVICO: TBCDField;
    cdsImprNFServicosNOME_CLIENTE: TStringField;
    cdsImprNfItemPECA_SQ: TIntegerField;
    cdsImprNfItemCODIGO_PECA: TStringField;
    cdsImprNfItemDESCRICAO_PECA: TStringField;
    cdsImprNfItemCLASS_FISCAL: TStringField;
    cdsImprNfItemVLR_TOTAL_ITEM: TBCDField;
    cdsImprNfItemVLR_UNIT_ITEM: TBCDField;
    cdsImprNfItemQTDE_ITEM: TIntegerField;
    cdsImprNfItemUN_PECA: TStringField;
    cdsImprNfItemSTRIBUT: TIntegerField;
    cdsImprNfItemVLR_IPI_ITEM: TBCDField;
    cdsImprNfItemALIQ_IPI_ITEM: TBCDField;
    cdsImprNfItemALIQ_ICMS_ITEM: TBCDField;
    cdsImprNfItemNR_SERIE_ITEM: TMemoField;
    cdsImprPedItemNR_SERIE_ITEM: TMemoField;
    cdsImprPedItemCODIGO_PECA: TStringField;
    cdsImprPedItemDESCRICAO_PECA: TStringField;
    cdsImprPedItemQTDE_PEDIDO_ITEM: TIntegerField;
    cdsImprPedItemCODIGO_NBM: TStringField;
    cdsImprPedItemPRECO_UNIT: TBCDField;
    cdsImprPedItemVLR_DESC: TBCDField;
    cdsImprPedItemVLR_IPI_ITEM: TBCDField;
    cdsImprPedItemALIQ_ICMS_ITEM: TBCDField;
    cdsImprPedItemALIQ_IPI_ITEM: TBCDField;
    cdsImprPedItemVLR_TOTAL_ITEM: TBCDField;
    cdsImprAssistItemASSISTENCIA_ITEM_SQ: TIntegerField;
    cdsImprAssistItemASSISTENCIA_SQ: TIntegerField;
    cdsImprAssistItemPECA_SQ: TIntegerField;
    cdsImprAssistItemQTDE_ASSISTENCIA_ITEM: TIntegerField;
    cdsImprAssistItemPRECO_UNIT: TBCDField;
    cdsImprAssistItemCODIGO_PECA: TStringField;
    cdsImprAssistItemDESCRICAO_PECA: TStringField;
    cdsImprAssistItemCODIGO_NBM: TStringField;
    cdsImprEstPECA_SQ: TIntegerField;
    cdsImprEstCODIGO_PECA: TStringField;
    cdsImprEstDESCRICAO_PECA: TStringField;
    cdsImprEstQTDE_PECA_LOJA: TIntegerField;
    cdsImprEstQTDE_PECA_ARMAZEM: TIntegerField;
    cdsImprEstQTDE_PECA_DEMO: TIntegerField;
    cdsImprEstQTDE_PECA_DEFEITO: TIntegerField;
    cdsImprEstQTDE_PECA_EM_USO: TIntegerField;
    cdsImprEstQTDE_PECA_BACKUP: TIntegerField;
    cdsImprEstQTDE_PECA_DEMO_CLI: TIntegerField;
    cdsImprEstQTDE_PECA_HLC: TIntegerField;
    cdsImprEstNBM_SQ: TIntegerField;
    cdsImprEstMODELO_SQ: TIntegerField;
    cdsImprEstUN_PECA: TStringField;
    cdsImprEstMARCA_PECA: TStringField;
    cdsImprEstPRECO_UNIT_PECA: TBCDField;
    cdsImprEstTIPO_PECA: TIntegerField;
    cdsImprEstDESCRICAO_MODELO: TStringField;
    cdsImprEstCODIGO_NBM: TStringField;
    cdsImprHistClientes1qrImprHistClientes2: TDataSetField;
    cdsImprHistClientes2NFISCAL_SQ: TIntegerField;
    cdsImprHistClientes2NUMERO_NFISCAL: TIntegerField;
    cdsImprHistClientes2DTEMISSAO_NFISCAL: TDateTimeField;
    cdsImprHistClientes2COTACAO_DOLAR: TBCDField;
    cdsImprHistClientes2VLR_ICMS: TBCDField;
    cdsImprHistClientes2VLR_IPI: TBCDField;
    cdsImprHistClientes2VLR_FRETE: TBCDField;
    cdsImprHistClientes2FRETE_TRANSP: TStringField;
    cdsImprHistClientes2VLR_PRODUTOS: TBCDField;
    cdsImprHistClientes2VLR_TOTAL: TBCDField;
    cdsImprHistClientes2DESCRICAO_COND_PAGTO: TStringField;
    cdsImprHistClientes2DESCRICAO_NATUREZA: TStringField;
    cdsImprHistClientes2CFO: TStringField;
    cdsImprHistClientes2NOME_TRANSPORTADORA: TStringField;
    cdsImprHistClientes2NOME_VENDEDOR: TStringField;
    cdsImprHistClientes2qrImprHistClientes3: TDataSetField;
    cdsImprHistClientes3NFISCAL_ITEM_SQ: TIntegerField;
    cdsImprHistClientes3NFISCAL_SQ: TIntegerField;
    cdsImprHistClientes3ITEM: TIntegerField;
    cdsImprHistClientes3TIPO_ITEM: TStringField;
    cdsImprHistClientes3PECA_SQ: TIntegerField;
    cdsImprHistClientes3MODELO_SQ: TIntegerField;
    cdsImprHistClientes3NR_SERIE_ITEM: TMemoField;
    cdsImprHistClientes3CLASS_FISCAL: TStringField;
    cdsImprHistClientes3STRIBUT: TIntegerField;
    cdsImprHistClientes3QTDE_ITEM: TIntegerField;
    cdsImprHistClientes3VLR_UNIT_ITEM: TBCDField;
    cdsImprHistClientes3VLR_TOTAL_ITEM: TBCDField;
    cdsImprHistClientes3ALIQ_ICMS_ITEM: TBCDField;
    cdsImprHistClientes3ALIQ_IPI_ITEM: TBCDField;
    cdsImprHistClientes3VLR_ICMS_ITEM: TBCDField;
    cdsImprHistClientes3VLR_IPI_ITEM: TBCDField;
    cdsImprHistClientes3CODIGO_PECA: TStringField;
    cdsImprHistClientes3DESCRICAO_PECA: TStringField;
    cdsImprHistClientes3CODIGO_NBM: TStringField;
    cdsImprHistClientes3DESCRICAO_MODELO: TStringField;
    cdsImprClientesUFCLIENTE_SQ: TIntegerField;
    cdsImprClientesUFCODIGO_CLIENTE: TStringField;
    cdsImprClientesUFNOME_CLIENTE: TStringField;
    cdsImprClientesUFINSCR_ESTADUAL: TStringField;
    cdsImprClientesUFENDERECO: TStringField;
    cdsImprClientesUFNUMERO: TStringField;
    cdsImprClientesUFBAIRRO: TStringField;
    cdsImprClientesUFCOMPL_ENDERECO: TStringField;
    cdsImprClientesUFCIDADE: TStringField;
    cdsImprClientesUFESTADO: TStringField;
    cdsImprClientesUFCEP: TStringField;
    cdsImprClientesUFDDD_FONE1: TStringField;
    cdsImprClientesUFNUMERO_FONE1: TStringField;
    cdsImprClientesUFCOMPL_FONE1: TStringField;
    cdsImprClientesUFDDD_FONE2: TStringField;
    cdsImprClientesUFNUMERO_FONE2: TStringField;
    cdsImprClientesUFCOMPL_FONE2: TStringField;
    cdsImprClientesUFDDD_FONE3: TStringField;
    cdsImprClientesUFNUMERO_FONE3: TStringField;
    cdsImprClientesUFCOMPL_FONE3: TStringField;
    cdsImprClientesUFDDD_CELULAR: TStringField;
    cdsImprClientesUFNUMERO_CELULAR: TStringField;
    cdsImprClientesUFCOMPL_CELULAR: TStringField;
    cdsImprClientesUFDDD_FAX: TStringField;
    cdsImprClientesUFNUMERO_FAX: TStringField;
    cdsImprClientesUFCOMPL_FAX: TStringField;
    cdsImprClientesUFE_MAIL: TStringField;
    cdsImprClientesUFWEB_SITE: TStringField;
    cdsImprClientesUFCONTATO: TStringField;
    cdsImprClientesUFPAIS: TStringField;
    cdsImprClientesUFREVENDA: TStringField;
    cdsImprClientesUFBIRO: TStringField;
    cdsImprClientesUFQTDE: TBCDField;
    cdsImprClientesUFVALOR: TBCDField;
    cdsImprClientesUFDATA: TDateTimeField;
    cdsImprAssistEquipASSISTENCIA_EQUIP_SQ: TIntegerField;
    cdsImprAssistEquipASSISTENCIA_SQ: TIntegerField;
    cdsImprAssistEquipMODELO_SQ: TIntegerField;
    cdsImprAssistEquipNR_SERIE_EQUIP: TMemoField;
    cdsImprAssistEquipDEFEITO: TBlobField;
    cdsImprAssistEquipCODIGO_MODELO: TStringField;
    cdsImprAssistEquipDESCRICAO_MODELO: TStringField;
    cdsImprAssistEquipCODIGO_NBM: TStringField;
    procedure cdsImprHistClientes1AfterScroll(DataSet: TDataSet);
    procedure cdsImprHistClientes2AfterScroll(DataSet: TDataSet);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  DMImpr: TDMImpr;

implementation

uses UImprimirClientesHist;

{$R *.dfm}

procedure TDMImpr.cdsImprHistClientes1AfterScroll(DataSet: TDataSet);
begin
  cdsImprHistClientes2.Close;
  cdsImprHistClientes2.Params.ParamByName ('CLIENTE_SQ').Value := cdsImprHistClientes1CLIENTE_SQ.Text;
  cdsImprHistClientes2.Open;
  FImprimirClientesHist.CalculaTotais;
end;

procedure TDMImpr.cdsImprHistClientes2AfterScroll(DataSet: TDataSet);
begin
  cdsImprHistClientes3.Close;
  cdsImprHistClientes3.Params.ParamByName ('NFISCAL_SQ').Value := cdsImprHistClientes2NFISCAL_SQ.Text;
  cdsImprHistClientes3.Open;
end;

end.
