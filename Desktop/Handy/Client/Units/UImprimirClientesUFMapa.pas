unit UImprimirClientesUFMapa;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, OleCtrls, SHDocVw, MSHTML;

type
  TFImprimirClientesUFMapa = class(TForm)
    WebBrowser1: TWebBrowser;
    procedure FormActivate(Sender: TObject);
    procedure WebBrowser1NavigateComplete2(Sender: TObject;
      const pDisp: IDispatch; var URL: OleVariant);
    procedure WebBrowser1DocumentComplete(Sender: TObject;
      const pDisp: IDispatch; var URL: OleVariant);
  private
    function carregaHTML: String;
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FImprimirClientesUFMapa: TFImprimirClientesUFMapa;

implementation

uses UDM, UImprimirClientesUF;

{$R *.dfm}

procedure TFImprimirClientesUFMapa.FormActivate(Sender: TObject);
begin
  WebBrowser1.Navigate('http://blank');
end;

procedure TFImprimirClientesUFMapa.WebBrowser1NavigateComplete2(
  Sender: TObject; const pDisp: IDispatch; var URL: OleVariant);
var
  estado: String;
begin
  estado := URL;
  if Pos('estado=', estado) > 0 then
  begin
    estado := Copy (estado, Pos('estado=', estado)+7, 2);
    FImprimirClientesUF.estado := UpperCase(estado);
    ModalResult := mrOk;
  end;
end;

procedure TFImprimirClientesUFMapa.WebBrowser1DocumentComplete(
  Sender: TObject; const pDisp: IDispatch; var URL: OleVariant);
begin
  if ((WebBrowser1.Document <> nil) and (URL = 'http://blank/')) then
  begin
    IHTMLElement(IHTMLDocument2(WebBrowser1.Document).body).innerHTML := carregaHTML;
  end;
end;

function TFImprimirClientesUFMapa.carregaHTML(): String;
begin
  result := '<html>'
+ '<head>'
+ '<meta http-equiv="Content-Type" content="text/html">'
+ '<meta name="GENERATOR" content="Forthtech Map Designer Pro v.2.22">'
+ '<title>Mapa do Brasil</title>'
+ '</head>'
+ ''
+ '<body bgcolor="#ffffff" text="#000000" link="#000000" vlink="#000000" alink="#0000FF">'
+ ''
+ '<IMG SRC="mapaEstados.jpg" WIDTH=504 HEIGHT=502 BORDER=0 ISMAP USEMAP="#mapaEstados.jpg">'
+ ''
+ '<MAP NAME="mapaEstados.jpg">'
+ '<AREA SHAPE="POLYGON" COORDS="122,19,146,21,165,15,177,4,186,19,187,40,195,56,195,67,183,67,175,80,172,80,167,75,162,87,151,73,151,55,140,43,136,43,129,36,122,19,122,19" NOHREF ALT="RR" HREF="WebServer.exe/consultarMapa?estado=RR">'
+ '<AREA SHAPE="POLYGON" COORDS="55,46,55,57,63,59,63,63,54,63,54,75,61,87,54,126,43,122,18,140,15,155,9,163,54,175,96,194,120,185,137,170,150,174,163,183,197,182,204,166,197,158,228,99,215,96,195,77,195,70,183,70,175,83,172,83,168,79,162,91,160,91,149,75,'
+ '149,57,139,46,127,49,112,62,110,62,110,57,107,57,99,62,87,43,74,49,55,47" NOHREF ALT="AM" HREF="WebServer.exe/consultarMapa?estado=AM">'
+ '<AREA SHAPE="POLYGON" COORDS="8,166,5,168,22,195,28,202,45,197,48,215,61,212,80,212,94,201,97,196,54,178,8,166" NOHREF ALT="AC" HREF="WebServer.exe/consultarMapa?estado=AC">'
+ '<AREA SHAPE="POLYGON" COORDS="98,197,105,193,112,192,118,188,121,188,137,173,148,175,159,183,160,208,177,207,181,225,170,243,130,230,115,219,111,196,104,197,104,198,97,198" NOHREF ALT="RO" HREF="WebServer.exe/consultarMapa?estado=RO">'
+ '<AREA SHAPE="POLYGON" COORDS="205,169,199,185,162,186,162,206,177,204,180,210,184,223,184,227,172,245,177,264,177,275,180,276,200,277,201,286,210,296,228,285,232,285,239,291,257,286,260,288,257,295,262,297,262,289,268,279,288,257,296,'
+ '234,292,219,298,203,299,199,220,192,206,168" NOHREF ALT="MT" HREF="WebServer.exe/consultarMapa?estado=MT">'
+ '<AREA SHAPE="POLYGON" COORDS="229,289,211,299,204,328,208,349,221,354,227,349,235,355,237,370,249,372,273,337,288,322,288,317,264,302,261,302,253,296,253,291,243,295,237,295,229,289" NOHREF ALT="MS" HREF="WebServer.exe/consultarMapa?estado=MS">'
+ '<AREA SHAPE="POLYGON" COORDS="248,377,248,393,254,395,254,400,264,399,276,404,279,404,287,399,300,399,304,397,310,397,310,398,314,398,315,394,319,393,314,385,305,382,303,364,291,364,289,359,263,359,251,377,248,377" NOHREF ALT="PR" '
+ 'HREF="WebServer.exe/consultarMapa?estado=PR">'
+ '<AREA SHAPE="POLYGON" COORDS="255,404,255,412,252,412,253,413,270,413,283,417,288,426,290,428,300,428,300,433,298,436,300,441,312,432,315,410,313,400,307,400,303,403,289,403,279,409,277,409,263,403,254,403" NOHREF ALT="SC" '
+ 'HREF="WebServer.exe/consultarMapa?estado=SC">'
+ '<AREA SHAPE="POLYGON" COORDS="249,414,233,426,213,451,223,452,231,460,240,464,260,482,264,479,264,483,257,487,257,497,265,491,273,475,271,471,271,470,281,461,282,453,287,455,287,457,280,464,274,471,275,476,288,464,299,442,294,441,'
+ '295,431,289,431,280,420,267,416,251,416,251,414" NOHREF ALT="RS" HREF="WebServer.exe/consultarMapa?estado=RS">'
+ '<AREA SHAPE="POLYGON" COORDS="268,355,290,355,295,361,307,361,309,379,316,381,321,391,336,378,350,375,351,376,354,376,359,370,363,361,360,361,348,365,338,359,336,353,339,346,332,340,328,327,312,331,309,326,299,324,290,326,281,334,276,339,268,355" '
+ 'NOHREF ALT="SP" HREF="WebServer.exe/consultarMapa?estado=SP">'
+ '<AREA SHAPE="POLYGON" COORDS="365,359,369,361,369,363,364,368,367,369,374,366,393,366,395,367,395,365,400,362,407,356,407,349,397,342,389,353,365,359" NOHREF ALT="RJ" HREF="WebServer.exe/consultarMapa?estado=RJ">'
+ '<AREA SHAPE="POLYGON" COORDS="410,310,411,324,399,337,408,347,419,331,420,331,422,330,427,314,418,308" NOHREF ALT="ES" HREF="WebServer.exe/consultarMapa?estado=ES">'
+ '<AREA SHAPE="POLYGON" COORDS="428,312,439,283,439,253,441,244,447,244,451,245,459,232,448,215,448,213,455,211,452,195,440,187,438,187,425,198,423,198,416,187,414,187,408,193,395,196,384,196,383,204,368,213,365,213,359,206,357,206,348,215,353,242,'
+ '353,263,372,256,376,256,401,268,406,269,406,272,410,276,413,276,422,277,425,284,425,287,415,298,419,304" NOHREF ALT="BA" HREF="WebServer.exe/consultarMapa?estado=BA">'
+ '<AREA SHAPE="POLYGON" COORDS="451,216,461,230,473,213,460,203,456,202,456,208,457,208,457,214,454,214,451,215" NOHREF ALT="SE" HREF="WebServer.exe/consultarMapa?estado=SE">'
+ '<AREA SHAPE="POLYGON" COORDS="455,199,455,195,459,193,467,199,473,199,490,194,487,202,481,209,474,212,465,204,455,199" NOHREF ALT="AL" HREF="WebServer.exe/consultarMapa?estado=AL">'
+ '<AREA SHAPE="POLYGON" COORDS="416,185,422,179,424,179,425,170,428,170,438,176,448,176,453,178,465,174,465,183,488,175,497,180,491,192,470,197,460,191,453,194,441,185,437,185,424,195" NOHREF ALT="PE" HREF="WebServer.exe/consultarMapa?estado=PE">'
+ '<AREA SHAPE="POLYGON" COORDS="450,161,463,158,463,163,471,166,473,166,476,161,495,161,499,168,496,177,490,173,487,173,467,181,468,172,465,171,454,175,450,173" NOHREF ALT="PB" HREF="WebServer.exe/consultarMapa?estado=PB">'
+ '<AREA SHAPE="POLYGON" COORDS="451,159,458,142,471,140,485,143,495,152,495,158,489,160,474,158,473,164,465,161,466,154" NOHREF ALT="RN" HREF="WebServer.exe/consultarMapa?estado=RN">'
+ '<AREA SHAPE="POLYGON" COORDS="415,116,426,157,426,167,441,174,447,174,447,161,457,141,469,139,443,117,429,111" NOHREF ALT="CE" HREF="WebServer.exe/consultarMapa?estado=CE">'
+ '<AREA SHAPE="POLYGON" COORDS="412,114,424,155,424,168,422,177,408,190,391,194,381,194,382,202,368,210,359,203,358,187,363,174,396,159,396,132,402,119" NOHREF ALT="PI" HREF="WebServer.exe/consultarMapa?estado=PI">'
+ '<AREA SHAPE="POLYGON" COORDS="408,113,403,116,399,120,393,132,394,158,362,171,355,189,357,202,350,202,345,192,344,185,348,177,349,174,342,174,338,167,340,144,336,141,325,140,346,120,356,88,379,99,376,111,390,105" NOHREF ALT="MA" '
+ 'HREF="WebServer.exe/consultarMapa?estado=MA">'
+ '<AREA SHAPE="POLYGON" COORDS="355,88,343,119,320,141,324,143,326,151,315,163,315,177,299,197,222,190,207,164,200,158,231,98,218,94,197,76,198,56,215,49,232,47,233,41,248,43,248,52,263,61,271,79,284,90,290,88,295,89,300,99,313,101,335,81" '
+ 'NOHREF ALT="PA" HREF="WebServer.exe/consultarMapa?estado=PA">'
+ '<AREA SHAPE="POLYGON" COORDS="250,43,250,52,266,60,273,77,286,87,289,84,290,75,301,70,301,65,310,55,300,49,291,16,287,19,273,46" NOHREF ALT="AP" HREF="WebServer.exe/consultarMapa?estado=AP">'
+ '<AREA SHAPE="POLYGON" COORDS="327,143,337,144,338,152,336,168,340,175,346,177,342,184,342,192,349,205,355,205,346,214,349,237,343,241,326,242,319,234,316,234,310,239,299,233,295,220,302,196,317,178,318,163,327,154,329,151" NOHREF ALT="TO" '
+ 'HREF="WebServer.exe/consultarMapa?estado=TO">'
+ '<AREA SHAPE="POLYGON" COORDS="320,278,320,284,328,284,328,278" NOHREF ALT="DF" HREF="WebServer.exe/consultarMapa?estado=DF">'
+ '<AREA SHAPE="POLYGON" COORDS="291,317,291,322,293,322,293,321,305,321,315,327,330,323,336,339,343,344,340,355,348,361,386,351,398,331,407,321,407,305,411,306,416,304,412,297,422,285,421,280,411,280,409,279,403,272,375,258,352,266,346,264,'
+ '341,268,341,276,336,280,339,292,332,296,329,307,311,306" NOHREF ALT="MG" HREF="WebServer.exe/consultarMapa?estado=MG">'
+ '<AREA SHAPE="POLYGON" COORDS="320,278,320,285,329,285,329,278,320,278,288,262,299,237,312,241,317,237,328,245,343,245,350,239,350,260,343,260,337,267,337,274,333,276,331,281,334,289,328,294,326,303,309,302,288,314,266,298,266,290,275,277,275,274,287,262" '
+ 'ALT="GO" HREF="WebServer.exe/consultarMapa?estado=GO">'
+ '</MAP>'
+ ''
+ '</body>'
+ '</html>'

end;

end.
